NGUSER [a-zA-Z\.\@\-\+_%]+
<%= @logstash_filter_pattern_params['nginx_filter_error_message'] %> (((?<timestamp>\d{4}/\d{2}/\d{2} \d{2}:\d{2}:\d{2}) \[%{DATA}\] (%{NUMBER:nginx_pid:int}#%{NUMBER}: \*%{NUMBER}|\*%{NUMBER}) %{DATA}(?:, client: (?<nginx_client_ip_host>%{IP}|%{HOSTNAME}))(?:, server: %{IPORHOST})(?:, request: (?:%{URI:nginx_request}|%{URIPATHPARAM:nginx_request}))?(?:, host: %{HOSTNAME:nginx_vhost})?(?:, referrer: (?:\"(?:%{URI:nginx_referrer}|-)\"|%{QS:nginx_referrer}))?)|(%{DATA} %{WORD:nginx_webserver} %{HOSTNAME}\-%{WORD:nginx_class}\: (?<timestamp>%{YEAR}[./-]%{MONTHNUM}[./-]%{MONTHDAY}[- ]%{TIME}) \[%{LOGLEVEL:nginx_severity}\] %{POSINT:nginx_pid:int}#%{NUMBER}: %{DATA}(?:, client: (?<nginx_client_ip_host>%{IP}|%{HOSTNAME}))(?:, server: %{IPORHOST})(?:, request: %{QS:nginx_request})?(?:, host: %{HOSTNAME:nginx_vhost})?(?:, referrer: \"%{URI:nginx_referrer})))
