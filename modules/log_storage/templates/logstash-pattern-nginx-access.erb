NGUSER [a-zA-Z\.\@\-\+_%]+
PROXY [0-9a-zA-Z\.\@\-\+_%():\s*]+
<%= @logstash_filter_pattern_params['nginx_filter_access_message'] %> ((%{IPORHOST:nginx_client_ip_host} %{NGUSER} %{NGUSER:nginx_auth} \[%{HTTPDATE:timestamp}\] \"%{WORD:nginx_http_method} (?:%{URI:nginx_request}|%{URIPATHPARAM:nginx_request}) HTTP/%{NUMBER:nginx_http_version}\" %{NUMBER:nginx_response} (?:%{NUMBER:nginx_sent_bytes:int}|-) (?:\"(?:%{URI:nginx_referrer}|-)\"|%{QS:nginx_referrer}) %{QS:nginx_user_agent})|(\[%{HTTPDATE:timestamp}\] %{HOSTNAME:nginx_vhost} %{IPORHOST:nginx_client_ip_host} \"%{WORD:nginx_http_method} (?:%{URI:nginx_request}|%{URIPATHPARAM:nginx_request}) HTTP/%{NUMBER:nginx_http_version}\" %{NUMBER:nginx_response} (?:\"(?:%{URI:nginx_referrer}|-)\"|%{QS:nginx_referrer}) %{QS:nginx_agent} (?:%{QS:nginx_cookie}|-) (?:%{QS:nginx_forwarded_for}|-) \[%{PROXY:nginx_proxy}.*\] (?:%{NUMBER:nginx_request_length}|-) (?:%{NUMBER:nginx_sent_bytes}|-) %{NUMBER:nginx_request_time}))
